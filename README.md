# MyCloud - Облачное хранилище файлов

## 1. API Документация

### Основные эндпоинты

#### Аутентификация

| Метод | Путь                   | Описание                          | Лимиты               |
|-------|------------------------|-----------------------------------|----------------------|
| POST  | /api/auth/register/    | Регистрация нового пользователя   | 50 запросов/час      |
| POST  | /api/auth/login/       | Вход в систему                   | 50 запросов/час      |
| POST  | /api/auth/logout/      | Выход из системы                 | Без лимитов          |
| GET   | /api/auth/users/me/    | Получение данных текущего пользователя | 1000 запросов/час |

#### Работа с файлами

| Метод | Путь                          | Описание                          | Лимиты               |
|-------|-------------------------------|-----------------------------------|----------------------|
| GET   | /api/storage/files/           | Получение списка файлов           | 100 запросов/мин     |
| POST  | /api/storage/files/           | Загрузка нового файла             | Макс. размер 2GB     |
| GET   | /api/storage/files/{id}/      | Получение информации о файле      | 100 запросов/мин     |
| DELETE| /api/storage/files/{id}/      | Удаление файла                    | 50 запросов/час      |
| GET   | /api/storage/files/{id}/download/ | Скачивание файла              | 50 запросов/час      |
| GET   | /api/storage/shared/{link}/   | Скачивание по публичной ссылке    | 100 запросов/час     |

#### Администрирование

| Метод | Путь                   | Описание                          | Лимиты               |
|-------|------------------------|-----------------------------------|----------------------|
| GET   | /api/auth/users/       | Список пользователей (только админ) | 100 запросов/час  |
| POST  | /api/auth/admin/create/| Создание администратора           | 10 запросов/час      |

### Лимиты API

1. **Размер файлов**:
   - Максимальный размер загружаемого файла: 2GB
   - Минимальный размер: 1KB

2. **Квоты хранилища**:
   - Обычные пользователи: 5GB по умолчанию
   - Администраторы: 10GB по умолчанию
   - Минимальный лимит: 1MB
   - Максимальный лимит: 100GB (только для админов)

3. **Ограничения запросов**:
   - Анонимные запросы: 100/день
   - Авторизованные пользователи: 500000/час
   - Регистрация/логин: 5000/час

4. **Ограничения для файлов**:
   - Максимальное количество полей в форме: 1000
   - Максимальное количество файлов за раз: 20

### Интерактивная документация

1. **Swagger UI** - интерактивный просмотр и тестирование API:
   - URL: `/api/docs/`

2. **ReDoc** - альтернативное представление документации:
   - URL: `/api/redoc/`

### Доступ к схеме API

Для разработчиков доступна raw-схема API в формате OpenAPI:

- URL: `/api/schema/`
  - Формат: `YAML/JSON`

## 2. Инструкция по локальному запуску проекта

### 2.1. Клонирование репозитория

```bash
git clone https://github.com/maxter9595/MyCloudApp.git
cd MyCloudApp
```

### 2.2. Настройка переменных окружения

```bash
cp backend/.env_example backend/.env
cp frontend/.env_example frontend/.env
```

### 2.3. Установка зависимостей и тестирование (фронтенд)

```bash
cd frontend
npm install
npm test
cd ..
```

### 2.4. Запуск Docker

```bash
docker-compose up --build -d
```

### 2.5. Настройка администратора и тестирование (бэкенд)

```bash
docker-compose ps
docker-compose exec backend python manage.py createsuperuser
```

* Данные администратора:

```
Логин: admin
Email: admin@mail.ru
Пароль: Admintest3273!
```

* Тестирование бэкенда:

```bash
docker-compose exec backend python manage.py test
```

### 2.6. Подключение к административной панели СУБД PostgreSQL

* Ссылка для подключения: http://localhost:5050/

* Данные администратора БД для входа в админку PostgreSQL:

```
Почта: admin@example.com
Пароль: admin123
```

* `Register...` ➝ `Server...`. Данные соединения:

```
Host: db
Port: 5432
Maintenance database: my_database
Username: postgres
Password: postgres
```

* Ключевые таблицы приложения из БД: `accounts_customuser`, `storage_userfile`

### 2.7. Открытие приложения

* Ссылка для открытия приложения: http://localhost:3000/

* Возможные проблемы:

  1. Ошибки портов: Убедитесь, что порты `8000`, `5050` и `5432` не заняты

  2. PGAdmin не подключается к БД: Проверьте, что контейнер `db` запущен (`docker-compose ps`)

  3. Проблемы с зависимостями: удалите папки `node_modules/` и `venv/`, затем пересоберите проект


